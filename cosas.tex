\documentclass[11pt, a4paper]{article}
\usepackage{anysize}



%==============================================
% Para agregar una imagen
% \pgfimage[width=0.9\textwidth]{imgs/cproject.png}
%
% Para agregar cÃ³digo
% \begin{lstlisting}[opts]
% \end{lstlisting}

%\begin{figure}[!h]
%\centering
%\pgfimage[width=0.9\textwidth]{imgs/cproject.png}
%\caption{Modelo de Quadrotor}
%\label{fig:QuadRotor}
%\end{figure}

%==============================================
\marginsize{3cm}{2cm}{1cm}{1cm}

\usepackage[spanish]{babel}
\usepackage{graphicx}
\usepackage{fancyhdr}
\usepackage[T1]{fontenc}
\usepackage{lmodern}
\usepackage{color}
\usepackage{listings}
\usepackage{hyperref}
\usepackage{pgf}

%=================================================
%=================================================

\begin{document}

%Cabeceras y pies de pÂ·gina
\pagestyle{fancy}
\lhead{\title}
\chead{}
\rhead{}

\lfoot{}
\cfoot{}
\rfoot{\thepage}

%=================================================
%=================================================
%\tableofcontents
%\newpage

%=================================================
\section{Proyecto}
Falta en alguna parte poner objetivos, para que o hacemos, que esperamos poder lograar y para que se pued eusar todo esto eque estamos haciendo.
%-------------------------------------------------------------
\subsection{Work Breakdown structure}

Esta es una referencia a lo que es un WBS \ref{ref:WBS}

\begin{figure}[!h]
\centering
\pgfimage[width=0.9\textwidth]{imgs/wbs.png}
\caption{WBS: Quadrotor Porject}
\label{fig:QuadRotor}
\end{figure}

%-------------------------------------------------------------
\subsection{Diagrama en bloques}

Aca deberia ir un diagrama de bloques en donde esten un PC por parte del segmento tierra y uno o más quadrotores. Deberia estar bueno qeu se vea que la comunicación es inalambrica y que en ppo el sistema esta pensando para comunicación Uplink/Downlink con GS y también CrossLink entre quads. 

%=================================================
\section{La aeronave}

%-------------------------------------------------------------
\subsection{Diagrama en bloques}

Esta faltando una imagne en donde se pueda ver que a aeronave esta compuesta por una bateria, 4 motores, 4 ESC, 4 helices, una computadora de abordo con comunicación a tierra y cross


%-------------------------------------------------------------
\subsection{Motherboard - Computadora de vuelo}

\subsubsection{Hardware}

En la figur \ref{fig:Motherboard} se puede observar un diagrama de bloques de la placa madre de la aeronave en su primera versión:
\begin{figure}[!h]
\centering
\pgfimage[width=0.7\textwidth]{imgs/MotherBoard.png}
\caption{Motherboard}
\label{fig:Motherboard}
\end{figure}

\subsubsection{Arquitectura de Software}

%=================================================
\section{Sistema de comunicaciones}

\subsection{Requerimientos}
Se necesitó implementar un subsistema de comunicaciones que sea confiable y que cumpla las siguientes carateristicas:

\begin{itemize}
\item Comunicación inalambrica entre nodos
\item Debe poder transportar diferentes tipos de datos en ambos sentidos por un mismo canal.
\end{itemize}

\subsection{Modelo}

El sistema se modela en 4 capas. A continuación se describe cada una de estas capas.

\begin{figure}[!h]
\centering
\pgfimage[width=0.7\textwidth]{imgs/modelo.png}
\caption{Modelo del sistema de comunicaciones}
\label{fig:Coms}
\end{figure}


\subsubsection{Física}
En enlace físico entre dispositios se hace mediante radios Xbee que implementan el protocolo ZigBee. Por el momento las radios Xbee se usan en modo transparente y son una conexión inalambrica de UARTS.
No se utiliza el modo de direccionamiento de los XBee. De haber direccionamiento se implementará en capas superiores.

\subsubsection{Enlace}

Las comunicaciones se realizan de UART a UART. La misma transporta siempre a de a 1 byte de información a 115200bps. En esta capa se debe implementar un sistema de buffer que permite almacenar los datos recibidos mientras se esta realizando alguna otra tarea.
En la implementación del BSP de la UART para el LPCXpresso se utilizará DMA como un método de double buffering.

\subsubsection{Transporte}

Esta capa es la encarga de determinar que los datos que lleguen y salgan cumplan con un formato preestablecido. De esta manera se pueden detectar errores en la comunicación y también permite un primer nivel de parseo de datos ya que permite distinguir diferentes tipos de paquetes.

Un paquete de en esta capa tiene la siguiente forma:

\begin{figure}[!h]
\centering
\pgfimage[width=0.9\textwidth]{imgs/mensaje.png}
\caption{Mensaje}
\label{fig:Mensaje}
\end{figure}

De donde se puede ver que los paquetes tienen una carga útil (mensajes de la capa de aplicación) del longitud variable y su tamaño puede variar entre 0 y 255 bytes. Luego la capa de aplicación es la encargada de dividir el paquete si el tamaño máximo no es suficiente. 

La implementación de esta capa es la responsable de determinar que los paquetes lleguen en forma y se envien en forma, es decir:

\begin{itemize}
\item verificar las direcciones de source y destination
\item verificar el numero de secuencia o timestamp si es necesario
\item verificar el checksum
\end{itemize}

El campo de tipo de dato se encarga de determinar que tipo de datos se transporta en la carga util. Luego esto es redirigido según la aplicación a distintas secciones de la aplicación. Esto se explica en la siguiente subsección.

\subsubsection{Aplicación}

Los paquetes pueden tener 255 diferentes tipos de datos. Los implementados al día de hoy son:

\begin{itemize}
\item \textbf{SYSTEM:}Mensajes de control del sistema. Permite configurar el quadrotor e informar sobre acciones a tierra.
\item \textbf{CONTROL:} Mensajes de control de vuelo, cambio de posición, acciones, etc.
\item \textbf{DEBUG:}Mensajes de baja prioridad. Deben ser interpretados en bulk como caracteres ASCII y mostrados en una consola en el lado de TIERRA. En el lado del QUAD es opcional implementar un parser
\item \textbf{TELEMETRY:}Paquete de datos de telemetría.
\end{itemize}

%=================================================
\section{Segmento de tierra}

El segmento de tierra esta compuesto por una aplicación de comunicaciones principal. La misma, denominada RadioServer, es la encargada de enviar y recibir datos con la o las aeronaves. Dado que a traves del mismo canal se necesitaban enviar y recibir diferentes tipos de datos, y en general de diferentes tipos de aplicaciones ejecutandose, por ejemplo, en diferentes computadores. 

Se implemento un servidor escrito en Python que permite redireccionar a puertos TCP cada tipo de datos enviando todo lo recibido desde la aeronave a los diferentes clientes y viceversa.

Un esquema de este subsistema se muestra en la figura \ref{fig:ground_coms}.

\begin{figure}[!h]
\centering
\pgfimage[width=0.7\textwidth]{imgs/ground_coms.png}
\caption{Comunicacion en tierra}
\label{fig:ground_coms}
\end{figure}

Las ventajas encontradas en esta implementación son: versatilidad ya que la comunicacion por sockets esta ampliamente desarrolladas en la mayoria de los entornos de trabajo como ser: MATLAB y Simulink, C++, Python, Simualdores de vuelo, etc., multiples clientes pueden recibir la misma información y visualizarla o interpretarla de forma diferente, los clientes pueden estar distibuidos en diferentes computadoras dentro de una LAN o internet.





\end{document}